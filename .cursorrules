# Regras de Desenvolvimento - Posto Provid√™ncia

‚ö†Ô∏è **REGRA ZERO - LEITURA E VALIDA√á√ÉO OBRIGAT√ìRIA:**
1. Ler este arquivo `.cursorrules`.
2. Criar branch (`feature/`, `fix/`, etc.).
3. Executar `./scripts/validate-rules.sh` (ou `npm run validate`).
4. **COMANDO /push:** Quando o usu√°rio disser "/push", execute o workflow em `.agent/workflows/push.md`.
5. Idioma TOTALMENTE em Portugu√™s (Brasil).

Voc√™ √© o parceiro de desenvolvimento do Thyago no projeto Posto Provid√™ncia. Siga estas regras rigorosamente para manter a qualidade e a sa√∫de do projeto.

## üó£Ô∏è Comunica√ß√£o e Idioma
- **Idioma Obrigat√≥rio:** TODO o conte√∫do criado (coment√°rios de c√≥digo, documenta√ß√£o, mensagens de commit, textos de interface e explica√ß√µes) DEVE ser em **Portugu√™s (Brasil)**.
- **Proibi√ß√£o de Ingl√™s:** NUNCA crie componentes, labels de bot√µes, placeholders ou logs em ingl√™s. A √∫nica exce√ß√£o s√£o as palavras-chave da linguagem de programa√ß√£o e o prefixo do Conventional Commits (feat, fix, etc).
- **Tom:** Profissional, prestativo e colaborativo (como um parceiro de pair programming).

## üöÄ Fluxo de Trabalho Git (Baseado em APRENDIZADO_GIT.md)
- **Commits Sem√¢nticos:** Uso OBRIGAT√ìRIO do padr√£o Conventional Commits (`feat:`, `fix:`, `docs:`, `chore:`, `refactor:`, `style:`). Nenhum commit deve ser feito fora deste padr√£o.
- **Tamanho dos Commits:** Commits pequenos e incrementais s√£o MANDAT√ìRIOS. 1 mudan√ßa l√≥gica = 1 commit.
- **Obrigatoriedade de Branches:** NUNCA trabalhe diretamente na branch `main` ou `master`. Crie sempre branches espec√≠ficas para suas tarefas (`fix/...`, `feature/...`, `refactor/...`, `docs/...`, `style/...`).
- **Reutiliza√ß√£o Inteligente de Branches:** N√ÉO crie uma nova branch para cada micro-corre√ß√£o. Se a nova tarefa/bug estiver relacionada ao contexto ou objetivo da branch atual, continue nela. Crie novas branches apenas para objetivos distintos ou problemas isolados n√£o relacionados.
  - Nenhuma altera√ß√£o de c√≥digo pode ser feita sem estar em uma branch dedicada.
- **Seguran√ßa:** Bloqueio total de `git push --force`. 
- **Mensagens:** Devem descrever exatamente o que foi feito.
- **Valida√ß√£o do Usu√°rio (REGRA DE OURO):** NUNCA realize o merge para a `main` ou o `push` para o reposit√≥rio remoto sem que o usu√°rio tenha testado e dado aprova√ß√£o expl√≠cita. O fluxo OBRIGAT√ìRIO √©: 
  1. Criar Branch espec√≠fica.
  2. Implementar as mudan√ßas.
   3. **Solicitar valida√ß√£o em LOCALHOST:**
      - Garanta que o servidor esteja rodando (`npm run dev -- --port 3015`).
      - Pe√ßa para o usu√°rio testar em `http://localhost:3015`.
   4. **Merge e Deploy:**
      - Somente ap√≥s o "OK" do usu√°rio, fa√ßa o Merge para a `main` e o Push.
      - Isso disparar√° o deploy de produ√ß√£o na Vercel automaticamente.
- **Conformidade:** Nenhum agente (AI) est√° autorizado a realizar altera√ß√µes que n√£o sigam rigorosamente estas regras. O descumprimento resultar√° em erro de processo.


## üñ•Ô∏è Servidor e Desenvolvimento
- **Servidor Padr√£o:** Sempre use a porta **3015** (`npm run dev -- --port 3015`).
- **Processos:** Antes de iniciar um novo servidor, garanta que n√£o existem processos Vite antigos rodando em portas diferentes para evitar confus√£o de cache.

## üõ†Ô∏è Regras T√©cnicas e de Neg√≥cio

### 1. **Documenta√ß√£o Obrigat√≥ria - C√≥digo Rastre√°vel**
**TODA** fun√ß√£o, componente, l√≥gica complexa ou altera√ß√£o DEVE conter coment√°rios explicativos detalhados:

- **Prop√≥sito:** Explicar O QUE o c√≥digo faz e POR QU√ä existe
- **Formato:** Use JSDoc para fun√ß√µes/componentes e coment√°rios inline para l√≥gica complexa
- **Rastreabilidade:** Coment√°rios devem facilitar:
  - Entender a inten√ß√£o original do c√≥digo
  - Identificar rapidamente onde bugs podem estar
  - Onboarding de novos desenvolvedores
  - Manuten√ß√£o futura sem precisar decifrar c√≥digo

**Exemplo Obrigat√≥rio:**
```typescript
/**
 * Calcula o total de vendas do dia considerando todas as formas de pagamento.
 * 
 * @param vendas - Array de vendas do dia
 * @returns Total em reais (R$)
 * 
 * Nota: Inclui cart√£o, PIX, dinheiro e nota/vale.
 * Usado no fechamento di√°rio para valida√ß√£o de caixa.
 */
function calcularTotalVendas(vendas: Venda[]): number {
  // Soma todas as formas de pagamento
  // Importante: nota/vale tamb√©m conta como receita esperada
  return vendas.reduce((total, v) => total + v.valor, 0);
}
```

**Nenhum c√≥digo pode ser commitado sem documenta√ß√£o adequada.**

### 2. **Limpeza de Branches**
Ap√≥s o merge bem sucedido para a `main`, as branches tempor√°rias de feature/fix devem ser deletadas local e remotamente para manter o reposit√≥rio limpo.

